Supabase environment variables missing; using in-memory DB for development.
Initializing In-Memory DB...
[INFO] [requeueWorker] started
Serving frontend from C:\Users\jogod\crm-backend\frontend\dist
Created table: units
[SECURITY] Auth Failed: unknown - Missing authorization header
ÔûÂ ­ƒÜÇ Real Integration Flow Tests
  ÔûÂ ­ƒöæ Auth & Access Control (Leads)
    [32mÔ£ö GET /leads requires auth [90m(67.869ms)[39m[39m
[SECURITY] Auth Success: User 2 (agent_1769126065967@test.com)
    [32mÔ£ö GET /leads accepts valid token [90m(12.0952ms)[39m[39m
[SECURITY] Auth Success: User 2 (agent_1769126065967@test.com)
    [32mÔ£ö GET /leads with invalid role/permission (cross-tenant check) [90m(36.4108ms)[39m[39m
  [32mÔ£ö ­ƒöæ Auth & Access Control (Leads) [90m(117.4479ms)[39m[39m
[Webhook] Connection not found for secret: wrong_secret
  ÔûÂ ­ƒôí WhatsApp Webhooks
    [32mÔ£ö POST /webhooks/whatsapp/evolution/:secret with INVALID secret returns 401 [90m(11.592ms)[39m[39m
    [32mÔ£ö POST /webhooks/whatsapp/invalid_provider/:secret returns 400 [90m(7.565ms)[39m[39m
[WHATSAPP] Webhook received from evolution (unknown)
[INFO] [MessageHandler] New message from 5511999887766 (Unit: 2, Provider: evolution)
    [31mÔ£û POST /webhooks/whatsapp/evolution/:secret with VALID payload returns 200 [90m(11.3852ms)[39m[39m
  [31mÔ£û ­ƒôí WhatsApp Webhooks [90m(32.5345ms)[39m[39m
[Auth] Login attempt: {
  email: 'flood@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
[Auth] Login attempt: {
  email: 'flood@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
[Auth] Login attempt: {
  email: 'flood@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
Created table: users (added admin)
In-Memory DB initialized successfully.
[Auth] Login attempt: {
  email: 'flood@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
[Auth] Login attempt: {
  email: 'flood@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
[SECURITY] Auth Failed: flood@test.com - Rate limit exceeded
[SECURITY] Auth Failed: flood@test.com - Rate limit exceeded
  ÔûÂ ­ƒøí´©Å Rate Limits
    [32mÔ£ö Should BLOCK requests without bypass header when flooded [90m(115.0037ms)[39m[39m
[Auth] Login attempt: {
  email: 'flood_bypass@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
[Auth] Login attempt: {
  email: 'flood_bypass@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
[Auth] Login attempt: {
  email: 'flood_bypass@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
[Auth] Login attempt: {
  email: 'flood_bypass@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
[Auth] Login attempt: {
  email: 'flood_bypass@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
[Auth] Login attempt: {
  email: 'flood_bypass@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
[Auth] Login attempt: {
  email: 'flood_bypass@test.com',
  hasPassword: true,
  contentType: 'application/json'
}
    [32mÔ£ö Should ALLOW requests WITH bypass header even if flooded [90m(74.0633ms)[39m[39m
  [32mÔ£ö ­ƒøí´©Å Rate Limits [90m(190.6039ms)[39m[39m
[31mÔ£û ­ƒÜÇ Real Integration Flow Tests [90m(348.9356ms)[39m[39m
[INFO] Flushing metrics to DB...
[ERROR] [requeueWorker] unexpected error supabase.from(...).select(...).in is not a function
[ERROR] [requeueWorker] unexpected error supabase.from(...).select(...).in is not a function
[ERROR] [requeueWorker] unexpected error supabase.from(...).select(...).in is not a function
